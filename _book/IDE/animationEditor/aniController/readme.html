
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Animation Controller · LayaAir3 Engine Documentation · LAYABOX</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-sidebar-style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-search-pro/search.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-versions-select/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-prism/prism-solarizedlight.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-flexible-alerts/style.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-auto-scroll-table/website.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-highlight/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../aniBake/readme.html" />
    
    
    <link rel="prev" href="../timelineGUI/readme.html" />
    

    
        <link rel="shortcut icon" href="./style/favicon-32.ico" type="image/x-icon">
    
    
        <link rel="bookmark" href="./style/favicon-32.ico" type="image/x-icon">
    
    
    
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="./style/layabox-152.png">
    
    
        
    
    
        
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" >
            
                <span>
            
                    
                    Beginners
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.1" data-path="../../../">
            
                <a href="../../../">
            
                    
                    Introduction
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.1.1" data-path="../../../basics/readme.html">
            
                <a href="../../../basics/readme.html">
            
                    
                    Features
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.1.2" data-path="../../../basics/developmentEnvironment/readme.html">
            
                <a href="../../../basics/developmentEnvironment/readme.html">
            
                    
                    Development Environment
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.2.1" data-path="../../../basics/developmentEnvironment/download/readme.html">
            
                <a href="../../../basics/developmentEnvironment/download/readme.html">
            
                    
                    Install
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.2.2" data-path="../../../basics/IDE/GUI/readme.html">
            
                <a href="../../../basics/IDE/GUI/readme.html">
            
                    
                    GUI
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.1.3" data-path="../../../basics/essentialSkills/readme.html">
            
                <a href="../../../basics/essentialSkills/readme.html">
            
                    
                    Essential Skills
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.3.1" data-path="../../../basics/language/readme.html">
            
                <a href="../../../basics/language/readme.html">
            
                    
                    Language
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.3.2" data-path="../../../basics/DevTools/readme.html">
            
                <a href="../../../basics/DevTools/readme.html">
            
                    
                    DevTools
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.3.3" data-path="../../../basics/LayaTree/readme.html">
            
                <a href="../../../basics/LayaTree/readme.html">
            
                    
                    LayaTree
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    Engine Basics
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../../../basics/IDE/readme.html">
            
                <a href="../../../basics/IDE/readme.html">
            
                    
                    IDE Basics
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" data-path="../../../basics/IDE/layouts/readme.html">
            
                <a href="../../../basics/IDE/layouts/readme.html">
            
                    
                    layouts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2" data-path="../../../basics/IDE/projecFolders/readme.html">
            
                <a href="../../../basics/IDE/projecFolders/readme.html">
            
                    
                    projecFolders
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.3" data-path="../../../basics/IDE/projectSettings/readme.html">
            
                <a href="../../../basics/IDE/projectSettings/readme.html">
            
                    
                    projectSettings
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.4" data-path="../../../basics/IDE/entry/readme.html">
            
                <a href="../../../basics/IDE/entry/readme.html">
            
                    
                    entry
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.5" data-path="../../../basics/IDE/importJsLibrary/readme.html">
            
                <a href="../../../basics/IDE/importJsLibrary/readme.html">
            
                    
                    import Js Library
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.6" data-path="../../../basics/IDE/Hierarchy/readme.html">
            
                <a href="../../../basics/IDE/Hierarchy/readme.html">
            
                    
                    Hierarchy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.7" data-path="../../../basics/IDE/assets/readme.html">
            
                <a href="../../../basics/IDE/assets/readme.html">
            
                    
                    assets
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.8" data-path="../../../basics/IDE/Inspector/readme.html">
            
                <a href="../../../basics/IDE/Inspector/readme.html">
            
                    
                    Inspector
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.9" data-path="../../../basics/IDE/Game/readme.html">
            
                <a href="../../../basics/IDE/Game/readme.html">
            
                    
                    Game
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.10" data-path="../../../basics/IDE/shortcutKeyCombinations/readme.html">
            
                <a href="../../../basics/IDE/shortcutKeyCombinations/readme.html">
            
                    
                    shortcutKey Combinations
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../../../basics/common/readme.html">
            
                <a href="../../../basics/common/readme.html">
            
                    
                    Engine General Basics
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.1" data-path="../../../basics/common/terms/readme.html">
            
                <a href="../../../basics/common/terms/readme.html">
            
                    
                    basics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.2" data-path="../../../basics/common/Component/readme.html">
            
                <a href="../../../basics/common/Component/readme.html">
            
                    
                    Component
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.3" data-path="../../../basics/common/Loader/readme.html">
            
                <a href="../../../basics/common/Loader/readme.html">
            
                    
                    Loader
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.4" data-path="../../../basics/common/Scene/readme.html">
            
                <a href="../../../basics/common/Scene/readme.html">
            
                    
                    Scene
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.5" data-path="../../../basics/common/Node/readme.html">
            
                <a href="../../../basics/common/Node/readme.html">
            
                    
                    Node
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.6" data-path="../../../basics/common/Timer/readme.html">
            
                <a href="../../../basics/common/Timer/readme.html">
            
                    
                    Timer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.7" data-path="../../../basics/common/Event/readme.html">
            
                <a href="../../../basics/common/Event/readme.html">
            
                    
                    Event
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.8" data-path="../../../basics/common/Tween/readme.html">
            
                <a href="../../../basics/common/Tween/readme.html">
            
                    
                    Tween
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.9" data-path="../../../basics/common/Pool/readme.html">
            
                <a href="../../../basics/common/Pool/readme.html">
            
                    
                    Pool
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.10" data-path="../../../basics/common/network/readme.html">
            
                <a href="../../../basics/common/network/readme.html">
            
                    
                    network
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.11" data-path="../../../basics/common/adaptScreen/readme.html">
            
                <a href="../../../basics/common/adaptScreen/readme.html">
            
                    
                    adaptScreen
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.12" data-path="../../../basics/common/Browser/readme.html">
            
                <a href="../../../basics/common/Browser/readme.html">
            
                    
                    Browser
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.13" data-path="../../../basics/common/device/readme.html">
            
                <a href="../../../basics/common/device/readme.html">
            
                    
                    device
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.13.1" data-path="../../../basics/common/device/media/readme.html">
            
                <a href="../../../basics/common/device/media/readme.html">
            
                    
                    media
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.13.2" data-path="../../../basics/common/device/motion/readme.html">
            
                <a href="../../../basics/common/device/motion/readme.html">
            
                    
                    motion
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2.14" data-path="../../../basics/common/Stat/readme.html">
            
                <a href="../../../basics/common/Stat/readme.html">
            
                    
                    Stat
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../../../basics/3D/readme.html">
            
                <a href="../../../basics/3D/readme.html">
            
                    
                    Basic of 3D Engine
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.3.1" data-path="../../../basics/3D/beginner/readme.html">
            
                <a href="../../../basics/3D/beginner/readme.html">
            
                    
                    beginner
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.2" data-path="../../../basics/3D/Transform/readme.html">
            
                <a href="../../../basics/3D/Transform/readme.html">
            
                    
                    Transform
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    Editor
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../../uiEditor/readme.html">
            
                <a href="../../uiEditor/readme.html">
            
                    
                    UI Editor
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="../../uiEditor/basic/readme.html">
            
                <a href="../../uiEditor/basic/readme.html">
            
                    
                    Basic Interaction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="../../uiEditor/widgets/readme.html">
            
                <a href="../../uiEditor/widgets/readme.html">
            
                    
                    widgets
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.2.1" data-path="../../../2D/displayObject/readme.html">
            
                <a href="../../../2D/displayObject/readme.html">
            
                    
                    Display Object
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.2.1.1" data-path="../../../2D/displayObject/Sprite/readme.html">
            
                <a href="../../../2D/displayObject/Sprite/readme.html">
            
                    
                    Sprite
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.1.2" data-path="../../../2D/displayObject/Animation/readme.html">
            
                <a href="../../../2D/displayObject/Animation/readme.html">
            
                    
                    Animation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.1.3" data-path="../../../2D/displayObject/Text/readme.html">
            
                <a href="../../../2D/displayObject/Text/readme.html">
            
                    
                    Text
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.1.4" data-path="../../../2D/displayObject/SoundNode/readme.html">
            
                <a href="../../../2D/displayObject/SoundNode/readme.html">
            
                    
                    Sound Node
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.1.5" data-path="../../../2D/displayObject/VideoNode/readme.html">
            
                <a href="../../../2D/displayObject/VideoNode/readme.html">
            
                    
                    Video Node
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.2" data-path="../../uiEditor/uiComponent/readme.html">
            
                <a href="../../uiEditor/uiComponent/readme.html">
            
                    
                    UIComponent
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.2.2.1" data-path="../../uiEditor/uiComponent/Image/readme.html">
            
                <a href="../../uiEditor/uiComponent/Image/readme.html">
            
                    
                    Image
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.2.2" data-path="../../uiEditor/uiComponent/Label/readme.html">
            
                <a href="../../uiEditor/uiComponent/Label/readme.html">
            
                    
                    Label
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.2.3" data-path="../../uiEditor/uiComponent/TextInput/readme.html">
            
                <a href="../../uiEditor/uiComponent/TextInput/readme.html">
            
                    
                    TextInput
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.2.2.3.1" data-path="../../uiEditor/uiComponent/TextArea/readme.html">
            
                <a href="../../uiEditor/uiComponent/TextArea/readme.html">
            
                    
                    TextArea
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.2.4" data-path="../../uiEditor/uiComponent/Clip/readme.html">
            
                <a href="../../uiEditor/uiComponent/Clip/readme.html">
            
                    
                    Clip
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.2.2.4.1" data-path="../../uiEditor/uiComponent/FontClip/readme.html">
            
                <a href="../../uiEditor/uiComponent/FontClip/readme.html">
            
                    
                    FontClip
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.2.5" data-path="../../uiEditor/uiComponent/Button/readme.html">
            
                <a href="../../uiEditor/uiComponent/Button/readme.html">
            
                    
                    Button
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.2.6" data-path="../../uiEditor/uiComponent/scroll/readme.html">
            
                <a href="../../uiEditor/uiComponent/scroll/readme.html">
            
                    
                    scroll
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.2.2.6.1" data-path="../../uiEditor/uiComponent/HScrollBar/readme.html">
            
                <a href="../../uiEditor/uiComponent/HScrollBar/readme.html">
            
                    
                    HScrollBar
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.2.6.2" data-path="../../uiEditor/uiComponent/VScrollBar/readme.html">
            
                <a href="../../uiEditor/uiComponent/VScrollBar/readme.html">
            
                    
                    VScrollBar
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.2.7" data-path="../../uiEditor/uiComponent/slider/readme.html">
            
                <a href="../../uiEditor/uiComponent/slider/readme.html">
            
                    
                    slider
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.2.2.7.1" data-path="../../uiEditor/uiComponent/readme.html">
            
                <a href="../../uiEditor/uiComponent/readme.html">
            
                    
                    HSlider
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.2.7.2" data-path="../../uiEditor/uiComponent/VSlider/readme.html">
            
                <a href="../../uiEditor/uiComponent/VSlider/readme.html">
            
                    
                    VSlider
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.2.8" data-path="../../uiEditor/uiComponent/ProgressBar/readme.html">
            
                <a href="../../uiEditor/uiComponent/ProgressBar/readme.html">
            
                    
                    ProgressBar
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.2.9" data-path="../../uiEditor/uiComponent/Box/readme.html">
            
                <a href="../../uiEditor/uiComponent/Box/readme.html">
            
                    
                    Box
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.2.2.9.1" data-path="../../uiEditor/uiComponent/HBoox/readme.md">
            
                <span>
            
                    
                    HBoox
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.2.9.2" data-path="../../uiEditor/uiComponent/VBox/readme.html">
            
                <a href="../../uiEditor/uiComponent/VBox/readme.html">
            
                    
                    VBox
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.2.9.3" data-path="../../uiEditor/uiComponent/Panel/readme.html">
            
                <a href="../../uiEditor/uiComponent/Panel/readme.html">
            
                    
                    Panel
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.2.10" data-path="../../uiEditor/uiComponent/List/readme.html">
            
                <a href="../../uiEditor/uiComponent/List/readme.html">
            
                    
                    List
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.2.2.10.1" data-path="../../uiEditor/uiComponent/Tree/readme.html">
            
                <a href="../../uiEditor/uiComponent/Tree/readme.html">
            
                    
                    Tree
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.2.11" data-path="../../uiEditor/uiComponent/optionBox/readme.html">
            
                <a href="../../uiEditor/uiComponent/optionBox/readme.html">
            
                    
                    optionBox
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.2.2.11.1" data-path="../../uiEditor/uiComponent/ComboBox/readme.html">
            
                <a href="../../uiEditor/uiComponent/ComboBox/readme.html">
            
                    
                    ComboBox
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.2.11.2" data-path="../../uiEditor/uiComponent/Radio/readme.html">
            
                <a href="../../uiEditor/uiComponent/Radio/readme.html">
            
                    
                    Radio
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.2.11.3" data-path="../../uiEditor/uiComponent/RadioGroup/readme.html">
            
                <a href="../../uiEditor/uiComponent/RadioGroup/readme.html">
            
                    
                    RadioGroup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.2.11.4" data-path="../../uiEditor/uiComponent/CheckBox/readme.html">
            
                <a href="../../uiEditor/uiComponent/CheckBox/readme.html">
            
                    
                    CheckBox
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.2.12" data-path="../../uiEditor/uiComponent/navigationMenu/readme.html">
            
                <a href="../../uiEditor/uiComponent/navigationMenu/readme.html">
            
                    
                    Navigation Menu
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.2.2.12.1" data-path="../../uiEditor/uiComponent/Tab/readme.html">
            
                <a href="../../uiEditor/uiComponent/Tab/readme.html">
            
                    
                    Tab
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.2.12.2" data-path="../../uiEditor/uiComponent/ViewStack/readme.html">
            
                <a href="../../uiEditor/uiComponent/ViewStack/readme.html">
            
                    
                    ViewStack
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.2.13" data-path="../../uiEditor/uiComponent/ColorPicker/readme.html">
            
                <a href="../../uiEditor/uiComponent/ColorPicker/readme.html">
            
                    
                    ColorPicker
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.2.14" data-path="../../uiEditor/uiComponent/OpenDataContextView/readme.html">
            
                <a href="../../uiEditor/uiComponent/OpenDataContextView/readme.html">
            
                    
                    OpenDataContextView
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.2.15" data-path="../../uiEditor/Dialog/readme.html">
            
                <a href="../../uiEditor/Dialog/readme.html">
            
                    
                    Dialog
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.3" data-path="../../uiEditor/uiComponent/skeleton/readme.html">
            
                <a href="../../uiEditor/uiComponent/skeleton/readme.html">
            
                    
                    skeleton
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.2.3.1" data-path="../../uiEditor/uiComponent/skeleton/spine/readme.html">
            
                <a href="../../uiEditor/uiComponent/skeleton/spine/readme.html">
            
                    
                    spine
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.3.2" data-path="../../uiEditor/uiComponent/skeleton/sk/readme.html">
            
                <a href="../../uiEditor/uiComponent/skeleton/sk/readme.html">
            
                    
                    sk
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.1.3" data-path="../../uiEditor/readme.html">
            
                <a href="../../uiEditor/readme.html">
            
                    
                    graphics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.4" data-path="../../uiEditor/Filter/readme.html">
            
                <a href="../../uiEditor/Filter/readme.html">
            
                    
                    Filter
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.5" data-path="../../uiEditor/runtime/readme.html">
            
                <a href="../../uiEditor/runtime/readme.html">
            
                    
                    runtime
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.6" data-path="../../uiEditor/use3D/readme.html">
            
                <a href="../../uiEditor/use3D/readme.html">
            
                    
                    use3D
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.7" data-path="../../uiEditor/textureCompress/readme.html">
            
                <a href="../../uiEditor/textureCompress/readme.html">
            
                    
                    textureCompress
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.8" data-path="../../uiEditor/3DUI/readme.html">
            
                <a href="../../uiEditor/3DUI/readme.html">
            
                    
                    3D UI
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../../sceneEditor/readme.html">
            
                <a href="../../sceneEditor/readme.html">
            
                    
                    Scene Editor
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="../../sceneEditor/basic/readme.html">
            
                <a href="../../sceneEditor/basic/readme.html">
            
                    
                    Basic Interaction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="../../../3D/Sprite3D/readme.html">
            
                <a href="../../../3D/Sprite3D/readme.html">
            
                    
                    Sprite3D
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.3" data-path="../../../3D/displayObject/readme.html">
            
                <a href="../../../3D/displayObject/readme.html">
            
                    
                    Display Object
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.4" data-path="../../../3D/Camera/readme.html">
            
                <a href="../../../3D/Camera/readme.html">
            
                    
                    Camera
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.5" data-path="../../../3D/Light/readme.html">
            
                <a href="../../../3D/Light/readme.html">
            
                    
                    Light
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.6" data-path="../../sceneEditor/environment/readme.html">
            
                <a href="../../sceneEditor/environment/readme.html">
            
                    
                    environment
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.7" data-path="../../../3D/useModel/readme.html">
            
                <a href="../../../3D/useModel/readme.html">
            
                    
                    useModel
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../readme.html">
            
                <a href="../readme.html">
            
                    
                    Animation Editor
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1" data-path="../timelineGUI/readme.html">
            
                <a href="../timelineGUI/readme.html">
            
                    
                    timeline GUI
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3.3.2" data-path="readme.html">
            
                <a href="readme.html">
            
                    
                    Animation Controller
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.3" data-path="../aniBake/readme.html">
            
                <a href="../aniBake/readme.html">
            
                    
                    Animation Bake
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../../particleEditor/readme.html">
            
                <a href="../../particleEditor/readme.html">
            
                    
                    Particle Editor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../../materialEditor/readme.html">
            
                <a href="../../materialEditor/readme.html">
            
                    
                    Material Editor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../../ShaderBlueprint/readme.html">
            
                <a href="../../ShaderBlueprint/readme.html">
            
                    
                    Shader Blueprint
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="../../Component/readme.html">
            
                <a href="../../Component/readme.html">
            
                    
                    Component
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.7.1" data-path="../../Component/Mesh/readme.html">
            
                <a href="../../Component/Mesh/readme.html">
            
                    
                    Mesh
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7.2" data-path="../../Component/Trail/readme.html">
            
                <a href="../../Component/Trail/readme.html">
            
                    
                    Trail
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7.3" data-path="../../Component/PixelLine/readme.html">
            
                <a href="../../Component/PixelLine/readme.html">
            
                    
                    Pixel Line
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7.4" data-path="../../Component/ReflectionProbe/readme.html">
            
                <a href="../../Component/ReflectionProbe/readme.html">
            
                    
                    Reflection Probe
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7.5" data-path="../../Component/VolumetricGI/readme.html">
            
                <a href="../../Component/VolumetricGI/readme.html">
            
                    
                    Volumetric GI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7.6" data-path="../../Component/StaticBatchVolume/readme.html">
            
                <a href="../../Component/StaticBatchVolume/readme.html">
            
                    
                    StaticBatchVolume
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7.7" data-path="../../Component/LOD/readme.html">
            
                <a href="../../Component/LOD/readme.html">
            
                    
                    LOD Group
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="../../prefab/readme.html">
            
                <a href="../../prefab/readme.html">
            
                    
                    prefab
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="../../layapackage/readme.html">
            
                <a href="../../layapackage/readme.html">
            
                    
                    layapackage
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.9.1" data-path="../../layapackage/plug-in/readme.html">
            
                <a href="../../layapackage/plug-in/readme.html">
            
                    
                    plug-in
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9.2" data-path="../../layapackage/pluginImport/readme.html">
            
                <a href="../../layapackage/pluginImport/readme.html">
            
                    
                    Plugin Import
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9.3" data-path="../../layapackage/Layabox/readme.html">
            
                <a href="../../layapackage/Layabox/readme.html">
            
                    
                    Official Plugins
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.9.3.1" data-path="../../layapackage/Layabox/LOD/readme.html">
            
                <a href="../../layapackage/Layabox/LOD/readme.html">
            
                    
                    LOD Reduction Plugin
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    advanced
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../../../2D/advanced/readme.html">
            
                <a href="../../../2D/advanced/readme.html">
            
                    
                    Advanced 2D
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="../../../2D/advanced/useText/readme.html">
            
                <a href="../../../2D/advanced/useText/readme.html">
            
                    
                    use Text
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.2" data-path="../../../2D/TiledMap/readme.html">
            
                <a href="../../../2D/TiledMap/readme.html">
            
                    
                    TiledMap
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.3" data-path="../../../2D/performanceOptimization/readme.html">
            
                <a href="../../../2D/performanceOptimization/readme.html">
            
                    
                    performance Optimization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.4" data-path="../../../2D/dom/readme.html">
            
                <a href="../../../2D/dom/readme.html">
            
                    
                    DOM
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../../../3D/advanced/readme.html">
            
                <a href="../../../3D/advanced/readme.html">
            
                    
                    Advanced 3D
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../../../3D/advanced/customShader/readme.html">
            
                <a href="../../../3D/advanced/customShader/readme.html">
            
                    
                    Custom Shader
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2" data-path="../../../3D/advanced/PostProcessing/readme.html">
            
                <a href="../../../3D/advanced/PostProcessing/readme.html">
            
                    
                    Post Processing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.3" data-path="../../../3D/advanced/CommandBuffer/readme.html">
            
                <a href="../../../3D/advanced/CommandBuffer/readme.html">
            
                    
                    Command Buffer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.4" data-path="../../../3D/advanced/performanceOptimization/readme.html">
            
                <a href="../../../3D/advanced/performanceOptimization/readme.html">
            
                    
                    performance Optimization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.5" data-path="../../../3D/WebXR/readme.html">
            
                <a href="../../../3D/WebXR/readme.html">
            
                    
                    WebXR
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.6" data-path="../../../3D/advanced/Unity/readme.html">
            
                <a href="../../../3D/advanced/Unity/readme.html">
            
                    
                    Unity Resource Plugin
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    Publishing
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../../../released/generalSetting/readme.html">
            
                <a href="../../../released/generalSetting/readme.html">
            
                    
                    General Setting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../../../released/web/readme.html">
            
                <a href="../../../released/web/readme.html">
            
                    
                    Web
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../../../released/miniGame/readme.html">
            
                <a href="../../../released/miniGame/readme.html">
            
                    
                    miniGame
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.3.1" data-path="../../../released/miniGame/wechat/readme.html">
            
                <a href="../../../released/miniGame/wechat/readme.html">
            
                    
                    wechat
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.2" data-path="../../../released/miniGame/byteDance/readme.html">
            
                <a href="../../../released/miniGame/byteDance/readme.html">
            
                    
                    tiktok
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.3" data-path="../../../released/miniGame/OPPO/readme.html">
            
                <a href="../../../released/miniGame/OPPO/readme.html">
            
                    
                    OPPO
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.4" data-path="../../../released/miniGame/vivo/readme.html">
            
                <a href="../../../released/miniGame/vivo/readme.html">
            
                    
                    vivo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.5" data-path="../../../released/miniGame/xiaomi/readme.html">
            
                <a href="../../../released/miniGame/xiaomi/readme.html">
            
                    
                    xiaomi
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.6" data-path="../../../released/miniGame/alipaygame/readme.html">
            
                <a href="../../../released/miniGame/alipaygame/readme.html">
            
                    
                    alipaygame
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../../../released/native/LayaNative_Introduction/readme.html">
            
                <a href="../../../released/native/LayaNative_Introduction/readme.html">
            
                    
                    Native
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.4.1" data-path="../../../released/native/native_index/readme.html">
            
                <a href="../../../released/native/native_index/readme.html">
            
                    
                    native index
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.2" data-path="../../../released/native/build_Tool/readme.html">
            
                <a href="../../../released/native/build_Tool/readme.html">
            
                    
                    build Tool
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.3" data-path="../../../released/native/screen_orientation/readme.html">
            
                <a href="../../../released/native/screen_orientation/readme.html">
            
                    
                    screen orientation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.4" data-path="../../../released/native/loading_view_new/readme.html">
            
                <a href="../../../released/native/loading_view_new/readme.html">
            
                    
                    Loading View
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.5" data-path="../../../released/native/network/readme.html">
            
                <a href="../../../released/native/network/readme.html">
            
                    
                    network
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.6" data-path="../../../released/native/LocalStrorage/readme.html">
            
                <a href="../../../released/native/LocalStrorage/readme.html">
            
                    
                    Local Storage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.7" data-path="../../../released/native/Android_BackPress/readme.html">
            
                <a href="../../../released/native/Android_BackPress/readme.html">
            
                    
                    Android BackPress
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.8" data-path="../../../released/native/real_device_debugging/readme.html">
            
                <a href="../../../released/native/real_device_debugging/readme.html">
            
                    
                    Debugging JS on Android
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.9" data-path="../../../released/native/LayaDcc_Tool/readme.html">
            
                <a href="../../../released/native/LayaDcc_Tool/readme.html">
            
                    
                    LayaDcc Tool
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.10" data-path="../../../released/native/Secondary_Development/readme.html">
            
                <a href="../../../released/native/Secondary_Development/readme.html">
            
                    
                    Secondary Development
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.11" data-path="../../../released/native/webview/readme.html">
            
                <a href="../../../released/native/webview/readme.html">
            
                    
                    webview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.12" data-path="../../../released/native/built_in_font/readme.html">
            
                <a href="../../../released/native/built_in_font/readme.html">
            
                    
                    Fonts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.13" data-path="../../../released/native/zipUpdate/readme.html">
            
                <a href="../../../released/native/zipUpdate/readme.html">
            
                    
                    zip Update
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.14" data-path="../../../released/native/apk_expansion/readme.html">
            
                <a href="../../../released/native/apk_expansion/readme.html">
            
                    
                    APK Expansion
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.15" data-path="../../../released/native/build_Cmd/readme.html">
            
                <a href="../../../released/native/build_Cmd/readme.html">
            
                    
                    Command
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.16" data-path="../../../released/native/Other_settings/readme.html">
            
                <a href="../../../released/native/Other_settings/readme.html">
            
                    
                    Other
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../.." >Animation Controller</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><li><span class="title-icon "></span><a href="#detailed-explanation-of-animation-state-machine"><b></b>Detailed explanation of animation state machine</a></li><ul><li><span class="title-icon "></span><a href="#1-overview"><b></b>1. Overview</a></li><li><span class="title-icon "></span><a href="#2-animation-state-machine-component"><b></b>2. Animation state machine component</a></li><li><span class="title-icon "></span><a href="#3-animation-state-machine-file"><b></b>3. Animation state machine file</a></li><li><span class="title-icon "></span><a href="#4-animation-status"><b></b>4. Animation status</a></li><li><span class="title-icon "></span><a href="#5-animation-switching"><b></b>5. Animation switching</a></li><li><span class="title-icon "></span><a href="#6-animation-playback-and-scripts"><b></b>6. Animation playback and scripts</a></li><li><span class="title-icon "></span><a href="#7-sub-state-machine"><b></b>7. Sub-state machine</a></li></ul></ul></div><a href="#detailed-explanation-of-animation-state-machine" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><h1 id="detailed-explanation-of-animation-state-machine"><a name="detailed-explanation-of-animation-state-machine" class="anchor-navigation-ex-anchor" href="#detailed-explanation-of-animation-state-machine"><i class="fa fa-link" aria-hidden="true"></i></a>Detailed explanation of animation state machine</h1>
<p>LayaAir IDE&apos;s animation state machine, suitable for 2D and 3D.</p>
<p>For the function introduction in this article, if it is a common operation between 2D and 3D, 3D will be used as an example by default. If there are differences between 2D and 3D, additional explanations will be given for the differences.</p>
<blockquote>
<p>As the version is upgraded, some details of the screenshots in the document may be slightly different. The actual version of the IDE shall prevail. If the changes are major, we will make adjustments in time. If the changes are not made in time, please contact the official customer service for feedback.</p>
</blockquote>
<h2 id="1-overview"><a name="1-overview" class="anchor-navigation-ex-anchor" href="#1-overview"><i class="fa fa-link" aria-hidden="true"></i></a>1. Overview</h2>
<p>Let&#x2019;s first understand what an animation state machine is and its components, and then we&#x2019;ll learn more about each part later.</p>
<p>First of all, the animation state machine <code>Animator</code> allows us to define animation states and switching conditions between animation states to drive 3D objects to play different animations and show different behaviors. Then the animation state machine consists of the following parts:</p>
<ul>
<li>Animation state machine component <code>Animator Component</code>: It is a component on Sprite3D, used to control the interface of the animation state machine.</li>
<li>Animation state machine file <code>Animator Controller</code>: It is a file used to execute the entire state machine logic, drive the animation state to run, and perform state switching. At the same time, the driving parameters are defined. These parameters can be driven by code logic, and then the animation can be driven by these parameters.</li>
<li>Animation state <code>Animator State</code>: It is an animation state of the state machine. It is used to execute the logic of animation, define the properties of animation playback, and can change the playback position, time, level, etc. of a single animation.</li>
<li>Animator Transition <code>Animator Transition</code>: consists of parameters and comparison conditions. When the conditions are met, it will switch to the corresponding animation state. For each state, multiple transitions to other states can be created.</li>
</ul>
<p>Through the following figure, you can clearly understand the relationship between these four parts, as shown in Figure 1-1:</p>
<p><img src="img/1-1.png" alt="1-1"></p>
<p>(Picture 1-1)</p>
<h2 id="2-animation-state-machine-component"><a name="2-animation-state-machine-component" class="anchor-navigation-ex-anchor" href="#2-animation-state-machine-component"><i class="fa fa-link" aria-hidden="true"></i></a>2. Animation state machine component</h2>
<p>Objects that we need to play animations and use animation state machines need to add the <code>Animator</code> component. This component is an interface for controlling the animation state machine. Let&apos;s take a look at the <code>Animator</code> component.</p>
<h4 id="21-node-addition-in-the-scene"><a name="21-node-addition-in-the-scene" class="anchor-navigation-ex-anchor" href="#21-node-addition-in-the-scene"><i class="fa fa-link" aria-hidden="true"></i></a>2.1 Node addition in the scene</h4>
<p>Any node added in the scene can add animation state machine components. The following introduction takes cube as an example. First create a cube node in the scene. After <strong>selecting the cube node</strong>, you can add the <code>Animator</code> component in the <code>Add Component</code> panel of the editor. As shown in animation 2-1:</p>
<p><img src="img/2-1.gif" alt="2-1"></p>
<p>(Animation 2-1)</p>
<h4 id="22-added-to-prefab"><a name="22-added-to-prefab" class="anchor-navigation-ex-anchor" href="#22-added-to-prefab"><i class="fa fa-link" aria-hidden="true"></i></a>2.2 Added to prefab</h4>
<p>We can not only add animation state machine components to nodes in the scene, but also create them in prefabs.</p>
<blockquote>
<p>If you don&#x2019;t understand prefabs, please check the prefab documentation first <a href="../../prefab/readme.html">&lt;<prefab module="">&gt;</prefab></a>.</p>
</blockquote>
<p>From an operational point of view, there is no essential difference between creating on the scene and creating in a prefab.</p>
<p>The main differences are:</p>
<ul>
<li>Node creation in the scene is suitable for animations only used once.</li>
<li>Created in prefabs, suitable for situations where animations need to be reused multiple times.</li>
</ul>
<h4 id="23-added-by-default"><a name="23-added-by-default" class="anchor-navigation-ex-anchor" href="#23-added-by-default"><i class="fa fa-link" aria-hidden="true"></i></a>2.3 Added by default</h4>
<p>In some cases, the <code>Animator</code> component will be automatically added to the node, as shown in Figure 2-2. When we import an FBX model file into the scene, the <code>Animator</code> component has been added by default.</p>
<p><img src="img/2-2.png" alt="2-2"></p>
<p>(Figure 2-2)</p>
<h4 id="24-component-properties"><a name="24-component-properties" class="anchor-navigation-ex-anchor" href="#24-component-properties"><i class="fa fa-link" aria-hidden="true"></i></a>2.4 Component properties</h4>
<p>The properties of the <code>Animator</code> component are shown in Figure 2-3:</p>
<p><img src="img/2-3.png" alt="2-3"></p>
<p>(Figure 2-3)</p>
<p><code>Controller</code>: The <code>Animator Controller</code> file used. When there is an <code>Animator</code> component, the animation state machine still cannot be opened. We need to create an animation state machine file, which will be introduced in detail in the next chapter.</p>
<p><code>Culling Mode</code>: Culling mode, <code>Always Animate</code> means that animation playback updates will be performed even if the camera is invisible, <code>Cull Completely</code> means that all updates of the animation will be stopped when the camera is invisible.</p>
<p><code>Sleep</code>: Whether to stop updating when the animation is completed. Because in LayaAir, the last frame will still be looped after the animation is completed, so check Sleep to stop the update. For example, add a translation animation to a cube in the scene, as shown in animation 2-4. Finally, you will see that the cube is no longer moving.</p>
<p><img src="img/2-4.gif" alt="2-4"></p>
<p>(Animation 2-4)</p>
<p>At this time, uncheck the Sleep option and add an animation script to the CubeAnimation animation node. The added code is as follows:</p>
<pre class="language-"><code class="lang-typescript"><span class="token operator">...</span>
<span class="token keyword">import</span> Vector3 <span class="token operator">=</span> Laya<span class="token punctuation">.</span>Vector3<span class="token punctuation">;</span>
<span class="token operator">...</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AnimationScript</span> <span class="token keyword">extends</span> <span class="token class-name">Laya</span><span class="token punctuation">.</span>AnimatorStateScript <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token keyword">private</span> model<span class="token operator">:</span> Laya<span class="token punctuation">.</span>Sprite3D<span class="token punctuation">;</span>

    <span class="token comment">/**@internal */</span>
    <span class="token function">setPlayScriptInfo</span><span class="token punctuation">(</span>animator<span class="token operator">:</span> Laya<span class="token punctuation">.</span>Animator <span class="token operator">|</span> Laya<span class="token punctuation">.</span>Animator2D<span class="token punctuation">,</span> layerindex<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> playstate<span class="token operator">:</span> Laya<span class="token punctuation">.</span>AnimatorState <span class="token operator">|</span> Laya<span class="token punctuation">.</span>AnimatorState2D<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>model <span class="token operator">=</span> animator<span class="token punctuation">.</span>owner <span class="token keyword">as</span> Laya<span class="token punctuation">.</span>Sprite3D<span class="token punctuation">;</span><span class="token comment">//Get the Cube node</span>
    <span class="token punctuation">}</span>

    <span class="token operator">...</span>

    <span class="token comment">/**
    * Executed when the animation state exits.
    */</span>
    <span class="token function">onStateExit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Animation exited&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//Translation operation</span>
        <span class="token keyword">let</span> position <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vector3</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>model<span class="token punctuation">.</span>transform<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span>position<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>In the script, when the animation ends, the model is translated. However, since the Sleep option is not checked, the last frame will still be looped continuously after the animation is played, which is the final still state of animation 2-4. Therefore, it is impossible to control the position of the Cube to achieve the translation effect. When Sleep is checked, after the animation is completed, the panning effect can be displayed.</p>
<h2 id="3-animation-state-machine-file"><a name="3-animation-state-machine-file" class="anchor-navigation-ex-anchor" href="#3-animation-state-machine-file"><i class="fa fa-link" aria-hidden="true"></i></a>3. Animation state machine file</h2>
<p><code>Animator Controller</code> is a file used to execute the entire state machine logic, drive the animation state to run, and perform state switching.</p>
<h4 id="31-create-animation-state-machine-file"><a name="31-create-animation-state-machine-file" class="anchor-navigation-ex-anchor" href="#31-create-animation-state-machine-file"><i class="fa fa-link" aria-hidden="true"></i></a>3.1 Create animation state machine file</h4>
<p>In the Project panel, an animation state machine file can be created in any directory. As shown in animation 3-1:</p>
<p><img src="img/3-1.gif" alt="3-1"></p>
<p>(Animation 3-1)</p>
<h4 id="32-automatically-create-animation-state-machine-files"><a name="32-automatically-create-animation-state-machine-files" class="anchor-navigation-ex-anchor" href="#32-automatically-create-animation-state-machine-files"><i class="fa fa-link" aria-hidden="true"></i></a>3.2 Automatically create animation state machine files</h4>
<p>For an Fbx model file with mesh and animation information, as shown in Figure 3-2, during the import process of the Fbx file, the LayaAir 3.0 editor has recognized that the Fbx file has the <code>Animator</code> attribute, and can set whether it can be Turn on compression.</p>
<p><img src="img/3-2.png" alt="3-2"></p>
<p> (Figure 3-2)</p>
<p>When we drag the Fbx model into the scene, the animation state machine component is automatically added. Open the <code>Timeline Animation</code> panel and the animation state machine file will be automatically created, as shown in Figure 3-3:</p>
<p><img src="img/3-3.gif" alt="3-3"></p>
<p>(Figure 3-3)</p>
<p>In this case, LayaAir 3.0 has automatically created the <code>Animator Controller</code> file for us, and the next step is to edit the animation state machine.</p>
<h4 id="33-open-animation-state-machine"><a name="33-open-animation-state-machine" class="anchor-navigation-ex-anchor" href="#33-open-animation-state-machine"><i class="fa fa-link" aria-hidden="true"></i></a>3.3 Open animation state machine</h4>
<p>When we click on the animation state machine file, we can click on the <code>Animation State Machine</code> panel to open the animation state machine, as shown in Figure 3-4.</p>
<p><img src="img/3-4.png" alt="3-4"></p>
<p>(Figure 3-4)</p>
<p>The Sprite3D class of the LayaAir 3D engine provides the <code>getComponent()</code> method to obtain components on the model. When an animated model is loaded and created, the engine assigns the <code>Animator (animation state machine)</code> animation component by default, so we can get it like this:</p>
<pre class="language-"><code class="lang-typescript"><span class="token comment">//Get state machine</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>animator <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">getComponent</span><span class="token generic class-name"><span class="token operator">&lt;</span>Laya<span class="token punctuation">.</span>Animator<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>Laya<span class="token punctuation">.</span>Animator<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<blockquote>
<p>Note: This code comes from the &quot;Animator&quot; scene of &quot;3D Getting Started Example&quot;.</p>
</blockquote>
<h4 id="34-edit-animation-state-machine"><a name="34-edit-animation-state-machine" class="anchor-navigation-ex-anchor" href="#34-edit-animation-state-machine"><i class="fa fa-link" aria-hidden="true"></i></a>3.4 Edit animation state machine</h4>
<p> In the <code>Animation State Machine</code> panel, you can perform some regular operations, as shown in the animation 3-5. In the next chapter, we will introduce the introduction and operation of the animation state.</p>
<p><img src="img/3-5.gif" alt="3-5"></p>
<p>(Animation 3-5)</p>
<h4 id="35-animation-state-machine-layering"><a name="35-animation-state-machine-layering" class="anchor-navigation-ex-anchor" href="#35-animation-state-machine-layering"><i class="fa fa-link" aria-hidden="true"></i></a>3.5 Animation state machine layering</h4>
<p>By default, an animation state machine file has only one default layer <code>BaseLayer</code>, as shown in Figure 3-6. For example, for the regular actions of a character model (standby, running, attacking), we only need one default layer. .</p>
<p><img src="img/3-6.png" alt="image-20221205162952720" style="zoom: 80%;"></p>
<p>(Figure 3-6)</p>
<p>But we can also create more layers. What kind of problems can multiple layers be used to solve? Just imagine if you want to develop a third-person shooting game, then you definitely want the animation of the body to be divided into upper and lower parts. The upper part will animate based on the aiming position and whether to shoot, and the lower part will animate based on movement. Therefore, more complex requirements can be solved by layering. As shown in Figure 3-7, we added another layer and named it Layer1.</p>
<p><img src="img/3-7.png" alt="image-20221205164319707" style="zoom: 80%;"></p>
<p>(Figure 3-7)</p>
<h5 id="351-layer-properties"><a name="351-layer-properties" class="anchor-navigation-ex-anchor" href="#351-layer-properties"><i class="fa fa-link" aria-hidden="true"></i></a>3.5.1 Layer properties</h5>
<p>Each layer has some parameter attributes, as shown in Figure 3-8:</p>
<p><img src="img/3-8.png" alt="image-20221205164500506" style="zoom: 80%;"></p>
<p>(Figure 3-8)</p>
<p><strong>1.</strong><code>Name</code>: The name of the layer.</p>
<p><strong>2.</strong><code>Play On Wake</code>: Whether to play the animation of this layer by default.</p>
<p><strong>3.</strong><code>Blending Mode</code>: Animation blending method:</p>
<ul>
<li><code>Override</code>: Override, which means that the animation of the current layer will overwrite the animation of other layers. For example, when shooting and playing, the right hand cannot play other animations;</li>
<li><code>Additive</code>: Add, indicating that the amount of the animation of the current layer is added to the animation of other layers. For example, when shooting is played, the shaking of the hand running or standing will also be retained.</li>
</ul>
<p><strong>4.</strong><code>Default Weight</code>: The weight of the animation layer, the default Base Layer must be 1. If it is set to 0, the animation of the current layer will not play, and if it is 1, it will play. Between 0 and 1, a similar fusion situation will be used to play the animation, such as the situation of shooting while moving as mentioned before. If it is set to 0.5, it will shoot. When the animation is playing, the hand will only be raised to near the neck.</p>
<p>Through code, we can get the desired layer by using Animator&apos;s <code>animator.getControllerLayer(layerIndex)</code> method, which is defined as follows:</p>
<pre class="language-"><code class="lang-typescript">    <span class="token comment">/**
     * Get the controller layer.
     */</span>
    <span class="token function">getControllerLayer</span><span class="token punctuation">(</span>layerInex<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">:</span> AnimatorControllerLayer <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_controllerLayers<span class="token punctuation">[</span>layerInex<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
<p>To give an example of using this method:</p>
<pre class="language-"><code class="lang-typescript"><span class="token comment">//Get the BaseLayer layer AnimatorControllerLayer</span>
<span class="token keyword">let</span> animatorControllerLayer <span class="token operator">:</span> Laya<span class="token punctuation">.</span>AnimatorControllerLayer <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>animator<span class="token punctuation">.</span><span class="token function">getControllerLayer</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//Get the default animation state of the current BaseLayer layer</span>
<span class="token keyword">let</span> defaultState <span class="token operator">=</span> animatorControllerLayer<span class="token punctuation">.</span>defaultState<span class="token punctuation">;</span>
</code></pre>
<p><strong>5.</strong><code>Avatar Mask</code>: Action mask. After masking, the selected upper layer action will block the lower layer action. Let&#x2019;s illustrate with a specific example:</p>
<p>Suppose there are two layers, as shown in Figure 3-9, fight and congratulate,</p>
<p><img src="img/3-9.png" alt="3-9"></p>
<p>(Figure 3-9)</p>
<p>After setting the Blending Mode attribute to overwrite, the action of the congratulate layer will overwrite the action of the fight layer. The congratulate effect is shown in Figure 3-10.</p>
<p><img src="img/3-10.gif" alt="3-10"></p>
<p>(Animation 3-10)</p>
<p>The coverage at this time is to cover all the fight actions. If you want the upper body to be in fight action and the lower body to be in congratulate action, then action masking is needed. First, let&#x2019;s take a look at the fight action in Figure 3-11 for easy comparison. .</p>
<p><img src="img/3-11.gif" alt="3-11"></p>
<p>(Animation 3-11)</p>
<p>In the project resource panel, after adding <code>AvatarMask</code>, as shown in Figure 3-12, you can add prefab or model resources. Here, select the prefab and click the <code>Import Skeleton</code> button.</p>
<p><img src="img/3-12.png" alt="3-12"></p>
<p>(Figure 3-12)</p>
<p>After importing the skeleton, the selected part is the place to be masked. As shown in Figure 3-13, the skeleton of the lower body is checked here, so the movement of the lower body needs to be blocked.</p>
<p><img src="img/3-13.png" alt="3-13" style="zoom: 80%;"></p>
<p>(Figure 3-13)</p>
<p>Originally, the action of the congratulate layer would block the action of the fight layer, and all would be blocked. Now, add AvatarMask to the congratulate layer. According to the settings just made, the congratulate layer only blocks the lower body movements of the fight layer. That is, the upper body is still the movements of the fight layer and is not covered, and the movements of the lower body are blocked and become the movements of the congratulate layer. The effect is shown in the animation 3-14.</p>
<p><img src="img/3-14.gif" alt="3-14"></p>
<p>(Animation 3-14)</p>
<p>As you can see, the upper body is in fight action and the lower body is in congratulate action. This is how action masking is used.</p>
<blockquote>
<p>This is just the most basic usage. If there is only one animation layer, such as adding an animation mask to the lower body of the fight animation layer, then only the lower body animation will be displayed at this time.</p>
</blockquote>
<h5 id="352-layer-parameters"><a name="352-layer-parameters" class="anchor-navigation-ex-anchor" href="#352-layer-parameters"><i class="fa fa-link" aria-hidden="true"></i></a>3.5.2 Layer parameters</h5>
<p>Each layer can add some parameters, as shown in Figure 3-15. These parameters are specifically used in animation switching. We will introduce them in Chapter 5 Animation Switching.</p>
<p><img src="img/3-15.gif" style="zoom:50%;"></p>
<p>(Animation 3-15)</p>
<p>Currently in LayaAir, we can add these three parameters:</p>
<ul>
<li><code>Float</code>: floating point number</li>
<li><code>Bool</code>: Boolean</li>
<li><code>Trigger</code>: Trigger</li>
</ul>
<h2 id="4-animation-status"><a name="4-animation-status" class="anchor-navigation-ex-anchor" href="#4-animation-status"><i class="fa fa-link" aria-hidden="true"></i></a>4. Animation status</h2>
<p>Animation state <code>Animator State</code> is an animation state in the animation state machine. Each state corresponds to an animation, so it is called animation state. It is used to execute the logic of animation, define the properties of animation playback, and can change the playback position, time, etc. of a single animation. Our game logic state may consist of a series of animation states.</p>
<h4 id="41-system-status"><a name="41-system-status" class="anchor-navigation-ex-anchor" href="#41-system-status"><i class="fa fa-link" aria-hidden="true"></i></a>4.1 System status</h4>
<p>When the animation state machine is created, 2 system states will be created by default, as shown in Figure 4-1:</p>
<p><img src="img/4-1.png" alt="image-20221205174722419" style="zoom:33%;"></p>
<p>(Pic 4-1)</p>
<p>Any state <code>AnyState</code>: When we need to perform a switch when the condition is met, no matter which state it is, we can define the switch to start from this state.</p>
<p>Enter <code>Entry</code>: Enter the state. When entering an animation state machine, the switch from this state to the default state will be performed first.</p>
<p>When creating a <strong>sub-state machine</strong>, one more exit state will be created by default, as shown in Figure 4-2:</p>
<p><img src="img/4-2.png" alt="4-2"></p>
<p>(Figure 4-2)</p>
<blockquote>
<p>Please refer to Chapter 7 for the content of sub-state machines.</p>
</blockquote>
<p>Exit <code>Exit</code>: When you need to exit the sub-state machine, you can perform a switch to this state.</p>
<h4 id="42-create-animation-state"><a name="42-create-animation-state" class="anchor-navigation-ex-anchor" href="#42-create-animation-state"><i class="fa fa-link" aria-hidden="true"></i></a>4.2 Create animation state</h4>
<h5 id="421-create-new-animation-state"><a name="421-create-new-animation-state" class="anchor-navigation-ex-anchor" href="#421-create-new-animation-state"><i class="fa fa-link" aria-hidden="true"></i></a>4.2.1 Create new animation state</h5>
<p>In the animation state machine panel, right-click on a blank space and click Create Empty Node. As shown in animation 4-3:</p>
<p><img src="img/4-3.gif" alt="4-3"></p>
<p>(Animation 4-3)</p>
<h5 id="422-drag-into-an-animation-state"><a name="422-drag-into-an-animation-state" class="anchor-navigation-ex-anchor" href="#422-drag-into-an-animation-state"><i class="fa fa-link" aria-hidden="true"></i></a>4.2.2 Drag into an animation state</h5>
<p>In the Project panel, you can drag an action file under Fbx to the Animator panel, as shown in animation 4-4:</p>
<p><img src="img/4-4.gif" alt="4-4"></p>
<p>(Animation 4-4)</p>
<p>At this point, we can already play an animation automatically. This is the most basic and simple usage. No additional work is required to make LayaMonkey move!</p>
<p><img src="img/4-5.gif" style="zoom:50%;"></p>
<p>(Animation 4-5)</p>
<h4 id="43-animation-state-attributes"><a name="43-animation-state-attributes" class="anchor-navigation-ex-anchor" href="#43-animation-state-attributes"><i class="fa fa-link" aria-hidden="true"></i></a>4.3 Animation state attributes</h4>
<p>As each animation state in the animation state machine, we can make separate settings for this state, as shown in Figure 4-6:</p>
<p><img src="img/4-6.png" alt="4-6"></p>
<p>(Figure 4-6)</p>
<h5 id="431-basic-attributes"><a name="431-basic-attributes" class="anchor-navigation-ex-anchor" href="#431-basic-attributes"><i class="fa fa-link" aria-hidden="true"></i></a>4.3.1 Basic attributes</h5>
<p><code>Name</code>: The name of the animation state, which can be used to play animations in code.</p>
<p><code>Is Looping</code>: Whether to loop.</p>
<p><code>Speed</code>: animation playback speed.</p>
<p><code>Cycle Offset</code>: Cycle offset, an offset value based on the start time of playback, only applies to the first playback of the animation (between 0-1).</p>
<p><code>Clip Start</code>: The starting playback position of the animation file (between 0-1).</p>
<p><code>Clip End</code>: The stop position of the animation file (between 0-1).</p>
<p><code>Clip</code>: animation file (.lani).</p>
<blockquote>
<p>Note: The parameter &quot;Cycle Offset&quot; does not affect the integrity of animation playback. For example, if &quot;Clip Start&quot; is set to 0, &quot;Clip End&quot; is set to 1, and &quot;Cycle Offset&quot; is set to 0.8, then the animation will start playing from the position 0.8. Playing to the 0.8 position counts as a loop.</p>
</blockquote>
<p>Usually the animation files contained in the Fbx file will be automatically associated by dragging them into Animator, as shown in Figure 4-7:</p>
<p><img src="img/4-7.png" alt="4-7"></p>
<p>(Figure 4-7)</p>
<h5 id="432-switch-list"><a name="432-switch-list" class="anchor-navigation-ex-anchor" href="#432-switch-list"><i class="fa fa-link" aria-hidden="true"></i></a>4.3.2 Switch list</h5>
<p><code>AnimatorTransition</code>: Lists all animation switches that connect this animation state to other animation states, as shown in Figure 4-8:</p>
<p><img src="img/4-8.png" alt="4-8"></p>
<p>(Figure 4-8)</p>
<p>Standalone <code>New State -&gt; New State 0</code> can open the AnimatorTransition detailed panel. Double-click <code>New State -&gt; New State 0</code> to rename it, as shown in animation 4-9:</p>
<p><img src="img/4-9.gif" alt="4-9"></p>
<p>(Animation 4-9)</p>
<h5 id="433-solo-and-mute"><a name="433-solo-and-mute" class="anchor-navigation-ex-anchor" href="#433-solo-and-mute"><i class="fa fa-link" aria-hidden="true"></i></a>4.3.3 solo and mute</h5>
<p>Solo and mute: Two check boxes. Solo means that only this switch is effective. Mute is equivalent to disabling this animation switch, as shown in Figure 4-10:</p>
<p><img src="img/4-10.png" alt="4-10"></p>
<p>(Figure 4-10)</p>
<p><strong>Notice:</strong></p>
<blockquote>
<p>Both solo and mute can be multi-selected, but the priority is in the order of addition, which will be explained in 5.5 Switching Priority.</p>
<p>If the condition is met, it takes precedence over Solo/Mute. When the condition is not met, there will still be no transition. This will be explained in 5.5 Switching Priority.</p>
</blockquote>
<h2 id="5-animation-switching"><a name="5-animation-switching" class="anchor-navigation-ex-anchor" href="#5-animation-switching"><i class="fa fa-link" aria-hidden="true"></i></a>5. Animation switching</h2>
<p>The process of transitioning from one state to another is animation switching, which consists of parameters and comparison conditions. When the conditions are met, it will switch to the corresponding animation state. For each state, multiple transitions to other states can be created.</p>
<h4 id="51-create-animated-transitions"><a name="51-create-animated-transitions" class="anchor-navigation-ex-anchor" href="#51-create-animated-transitions"><i class="fa fa-link" aria-hidden="true"></i></a>5.1 Create animated transitions</h4>
<p>After we create the animation state, by right-clicking the mouse on the previous state and selecting Connection, a point of connection will be created. Drag the mouse to the subsequent animation state and lift the mouse to create an animation switch. Click When this connection is established, click the delete key on the keyboard to delete the connection. As shown in animation 5-1:</p>
<p><img src="img/5-1.gif" style="zoom:50%;"></p>
<p>(Animation 5-1)</p>
<p>When we connect New State 0, New State 1, and New State 2 from New State, New State will continue to switch to New State 0 without adding any conditions, because New State 0 is the first to connect.</p>
<h4 id="52-set-as-default"><a name="52-set-as-default" class="anchor-navigation-ex-anchor" href="#52-set-as-default"><i class="fa fa-link" aria-hidden="true"></i></a>5.2 Set as default</h4>
<p>When we create multiple animation states, if we want to set a certain animation state as the entry state, we can right-click the animation state and select Set as Default, as shown in Figure 5-2:</p>
<p><img src="img/5-2.gif" style="zoom:50%;"></p>
<p>(Animation 5-2)</p>
<blockquote>
<p>Note: When we create the first animation state, this state will be set as the default state by default. Of course, we can change other animation states to the default state at any time.</p>
</blockquote>
<h4 id="53-animation-switching-properties"><a name="53-animation-switching-properties" class="anchor-navigation-ex-anchor" href="#53-animation-switching-properties"><i class="fa fa-link" aria-hidden="true"></i></a>5.3 Animation switching properties</h4>
<p>When you click on a connection, you can see the properties of animation switching, as shown in Figure 5-3, which are used to handle the animation adjustment effect of animation switching.</p>
<p><img src="img/5-3.png" alt="5-3"></p>
<p>(Figure 5-3)</p>
<p><code>Exit Time</code>: This time is a normalized time of 0-1, used to define the percentage of time during animation playback. For example, 0.85 means that when the animation reaches 85%, the animation will start switching. The logical function of Exit Time is similar to the float parameter, but it cannot be set.</p>
<p><code>Transstartoffset</code>: This time is a normalized time of 0-1, the time offset of the target state, that is, the time point from which the target state animation starts to be played. For example, 0.5 means that the target state starts playing animation from 50%.</p>
<p><code>Transduration</code>: This time is a normalized time of 0-1, used to define the percentage of time that the next animation state will continue to play when the state switches to the target state. For example, 0.15 means that when the animation reaches 15% of the target animation, the switching animation will stop.</p>
<p><strong>Notice:</strong></p>
<blockquote>
<ul>
<li><p>During the transition time, animation 1 and animation 2 play at the same time. When the transition time ends, animation 1 stops playing completely, and animation 2 enters the next switching period.</p>
</li>
<li><p>When the transition time is 0, animation 1 will switch directly to animation 2.</p>
</li>
</ul>
</blockquote>
<p><code>Exit By Time</code>: Whether to enable Exit Time to take effect. If not checked, the animation will switch directly to the next animation.</p>
<p>Animation 5-3-1 and Animation 5-3-2 are the comparison effects of checking Exit Time and not checking it respectively. Obviously, if not checking, the animation will not be connected.</p>
<p><img src="img/5-3-1.gif" style="zoom:40%;"> <img src="img/5-3-2.gif" style="zoom:40%;"></p>
<p>(Animation 5-3-1)                                                 (Animation 5-3-2)</p>
<h4 id="54-animation-switching-conditions"><a name="54-animation-switching-conditions" class="anchor-navigation-ex-anchor" href="#54-animation-switching-conditions"><i class="fa fa-link" aria-hidden="true"></i></a>5.4 Animation switching conditions</h4>
<p>State switching can have one condition, multiple conditions, or no conditions. If there is no condition for switching, the animation system will also use Exit Time as the only condition and trigger the switch when the time is reached. If there are multiple conditions, all conditions must be met before switching is triggered.</p>
<p>Currently in LayaAir, we can add these three parameters:</p>
<h5 id="541-float-floating-point-number"><a name="541-float-floating-point-number" class="anchor-navigation-ex-anchor" href="#541-float-floating-point-number"><i class="fa fa-link" aria-hidden="true"></i></a>5.4.1 Float: Floating point number</h5>
<p>As shown in the animated picture 5-4, let&apos;s take a look at how to set the Float condition. First, we must define a Float parameter. Secondly, in the condition, you can select the Float parameter. Less or Greater will be selected on the right, and finally you can fill in the value. Then the meaning of animation 5-4 is that when Float is greater than 0.5, switch New State to New State0.</p>
<blockquote>
<p>Note: When defining this Float parameter, you can set a default value, such as 1. Then if the condition is that the Float parameter is Greater 0.5, the condition will be directly entered and the state will be switched directly during runtime.</p>
</blockquote>
<p><img src="img/5-4.gif" alt="5-4"></p>
<p> (Animation 5-4)</p>
<p>The conditions can be met through code, the code is as follows:</p>
<pre class="language-"><code class="lang-typescript"><span class="token comment">//Set the value of the &quot;Float&quot; parameter to meet the conditions for switching states.</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>animator<span class="token punctuation">.</span><span class="token function">setParamsNumber</span><span class="token punctuation">(</span> <span class="token string">&quot;Float&quot;</span> <span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>The running effect is as shown in Figure 5-5:</p>
<p><img src="img/5-5.gif" alt="5-5" style="zoom:67%;"></p>
<p>(Animation 5-5)</p>
<h5 id="542-bool&#xFF1A;boolean"><a name="542-bool&#xFF1A;boolean" class="anchor-navigation-ex-anchor" href="#542-bool&#xFF1A;boolean"><i class="fa fa-link" aria-hidden="true"></i></a>5.4.2 Bool&#xFF1A;Boolean</h5>
<p>As shown in the animated picture 5-6, let&apos;s take a look at how to set the Bool condition. First, we must define a Bool parameter (either true or false). Secondly, in the condition, we can select the Bool parameter, and finally we can check true or false. . Then the meaning of animation 5-6 is that when Bool is true, switch New State to New State0.</p>
<blockquote>
<p>Note: When defining this Bool parameter, you can set a default value, such as true. Then if the condition is the Bool parameter true, the condition will be directly marked, and the state will be switched directly during runtime.</p>
</blockquote>
<p><img src="img/5-6.gif" alt="5-6"></p>
<p>(Animation 5-6)</p>
<p>The conditions can be met through code, as follows:</p>
<pre class="language-"><code class="lang-typescript"><span class="token comment">//Set the value of the &quot;Bool&quot; parameter to meet the conditions for switching states.</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>animator<span class="token punctuation">.</span><span class="token function">setParamsBool</span><span class="token punctuation">(</span> <span class="token string">&quot;Bool&quot;</span> <span class="token punctuation">,</span> <span class="token boolean">true</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>The running effect is as shown in Figure 5-7:</p>
<p><img src="img/5-7.gif" alt="5-7" style="zoom:67%;"></p>
<p>(Animation 5-7)</p>
<h5 id="543-trigger"><a name="543-trigger" class="anchor-navigation-ex-anchor" href="#543-trigger"><i class="fa fa-link" aria-hidden="true"></i></a>5.4.3 Trigger:</h5>
<p>As shown in the animated picture 5-8, let&apos;s take a look at how to set the Trigger condition. First, we must define a Trigger parameter (either true or false). Secondly, in the condition, we can select the Trigger parameter. Then we can use triggers through code later to switch New State to New State0.</p>
<p><img src="img/5-8.gif" alt="5-8"></p>
<p>(Figure 5-8)</p>
<p>The conditions are met through code, as follows:</p>
<pre class="language-"><code class="lang-typescript"><span class="token comment">//Trigger &quot;Trigger&quot; to meet the conditions for switching states</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>animator<span class="token punctuation">.</span><span class="token function">setParamsTrigger</span><span class="token punctuation">(</span> <span class="token string">&quot;Trigger&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>The running effect is as shown in Figure 5-9:</p>
<p><img src="img/5-9.gif" alt="5-9" style="zoom:67%;"></p>
<p>(Animation 5-9)</p>
<h5 id="544-use-of-multiple-parameters"><a name="544-use-of-multiple-parameters" class="anchor-navigation-ex-anchor" href="#544-use-of-multiple-parameters"><i class="fa fa-link" aria-hidden="true"></i></a>5.4.4 Use of multiple parameters</h5>
<p>Of course we can define multiple parameters, but in this case it is more efficient to name the parameters. Modify the name as shown in the animation 5-10:</p>
<p><img src="img/5-10.gif" alt="5-10"></p>
<p>(Animation 5-10)</p>
<p>After modifying the name, you can edit the switching conditions more clearly, as shown in Figure 5-11:</p>
<p><img src="img/5-11.png" alt="5-11"></p>
<p>(Figure 5-11)</p>
<p><strong>Note: As long as one of these conditions is met, the animation switch can be triggered, not the relationship between AND</strong></p>
<h4 id="55-switch-priority"><a name="55-switch-priority" class="anchor-navigation-ex-anchor" href="#55-switch-priority"><i class="fa fa-link" aria-hidden="true"></i></a>5.5 Switch priority</h4>
<p>If there are multiple animation states in one animation state, let&apos;s take a look at the priority.</p>
<ul>
<li>When there are no conditions or when all conditions are met, solo and mute are not selected, as shown in Figure 5-12:</li>
</ul>
<p><img src="img/5-12.png" alt="5-12"></p>
<p>(Figure 5-12)</p>
<p>At this time, the Stand animation will be played after the Attack animation is played, because the Stand animation is the first one.</p>
<ul>
<li>When there are no conditions or when all conditions are met, if someone chooses solo, as shown in Figure 5-13:</li>
</ul>
<p><img src="img/5-13.png" alt="5-13"></p>
<p>(Figure 5-13)</p>
<p>At this time, the Run animation will be played after the Attack animation is played, because solo is selected for the Run animation.</p>
<ul>
<li>When there are no conditions or when all conditions are met, if solo is selected, as shown in Figure 5-14:</li>
</ul>
<p><img src="img/5-14.png" alt="5-14"></p>
<p>(Figure 5-14)</p>
<p>At this time, the Stand animation will be played after the Attack animation is played, because even if solo is selected, only one animation switch can be selected, and Stand is the first one in sequence.</p>
<ul>
<li>If the conditions for Attack-&gt;Stand are not met, the conditions for Attack-&gt;Run are met, but solo is still selected as shown in Figure 5-14 above.</li>
</ul>
<p>At this time, the Run animation will be played after the Attack animation is played, because the conditions of Attack-&gt;Stand are not met.</p>
<ul>
<li>When there are no conditions or when all conditions are met, if solo is selected and mute is selected in Attack-&gt;Stand, as shown in Figure 5-15:</li>
</ul>
<p><img src="img/5-15.png" alt="5-15"></p>
<p>(Figure 5-15)</p>
<p>At this time, the Run animation will be played after the Attack animation is played, because Attack-&gt;Stand selects mute.</p>
<ul>
<li>When there are no conditions or when all conditions are met, if solo and mute are both selected, as shown in Figure 5-16:</li>
</ul>
<p><img src="img/5-16.png" alt="5-16"></p>
<p>(Figure 5-16)</p>
<p>At this time, the Attack animation will not switch to any state after playing.</p>
<h2 id="6-animation-playback-and-scripts"><a name="6-animation-playback-and-scripts" class="anchor-navigation-ex-anchor" href="#6-animation-playback-and-scripts"><i class="fa fa-link" aria-hidden="true"></i></a>6. Animation playback and scripts</h2>
<p>In the above chapters, we only need to use simple code to control the state machine to meet the conditions and play the specified animation state. In addition, we can also control the animation playback through code.</p>
<h4 id="61-playback-control"><a name="61-playback-control" class="anchor-navigation-ex-anchor" href="#61-playback-control"><i class="fa fa-link" aria-hidden="true"></i></a>6.1 Playback Control</h4>
<p>After obtaining the animation state machine component and adding multiple animation states, how to play one of the animations? There are several ways to control and switch actions:</p>
<h5 id="611-play"><a name="611-play" class="anchor-navigation-ex-anchor" href="#611-play"><i class="fa fa-link" aria-hidden="true"></i></a>6.1.1 Play()</h5>
<p>Check out the <code>play()</code> method in the Animator animation component. The specific method parameters are as follows:</p>
<pre class="language-"><code class="lang-typescript"><span class="token comment">/**
* Play animation.
* @param name If null, the default animation will be played, otherwise the animation clip will be played by name.
* @param layerIndex layer index.
* @param normalizedTime Normalized playback start time.
*/</span>
<span class="token function">play</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> layerIndex<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> normalizedTime<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> Number<span class="token punctuation">.</span><span class="token constant">NEGATIVE_INFINITY</span><span class="token punctuation">)</span>
</code></pre>
<p>This is the most basic way to play animation in the animation state machine, through the following code:</p>
<pre class="language-"><code class="lang-typescript"><span class="token comment">//Animation state machine, directly play the Run animation state</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>animator<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token string">&quot;Run&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Take a look at the running effect, as shown in animation 6-1:</p>
<p><img src="img/6-1.gif" style="zoom:50%;"></p>
<p>(Animation 6-1)</p>
<p>The starting position of the animation can also be specified through the parameters of Play():</p>
<pre class="language-"><code class="lang-typescript"><span class="token comment">//Animation state machine, directly plays the Stand animation state, starting from the 50% position</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>animator<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token string">&quot;Stand&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Take a look at the running effect, as shown in Figure 6-2. Every time the mouse clicks the button, the Stand animation can start playing from the 50% position.</p>
<p> <img src="img/6-2.gif" style="zoom:50%;"></p>
<p>(Animation 6-2)</p>
<p>Of course, we can also modify the properties of the animation state through code to play different effects:</p>
<pre class="language-"><code class="lang-typescript"><span class="token comment">//Get the BaseLayer layer of the animation state machine, and you can also get other layers</span>
<span class="token keyword">let</span> acl<span class="token operator">:</span> Laya<span class="token punctuation">.</span>AnimatorControllerLayer <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>animator<span class="token punctuation">.</span><span class="token function">getControllerLayer</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//Get an animation state</span>
<span class="token keyword">let</span> state <span class="token operator">=</span> acl<span class="token punctuation">.</span><span class="token function">getAnimatorState</span><span class="token punctuation">(</span><span class="token string">&quot;Stand&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//Set the name of the action state</span>
state<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Stand_new&quot;</span><span class="token punctuation">;</span>
<span class="token comment">//Set the start time of action state playback (the start time and end time are set to a percentage value of 0-1) The time point to be intercepted / the total duration of the animation</span>
state<span class="token punctuation">.</span>clipStart <span class="token operator">=</span> <span class="token number">10</span><span class="token operator">/</span><span class="token number">40</span><span class="token punctuation">;</span>
<span class="token comment">//Set the end time of action state playback</span>
state<span class="token punctuation">.</span>clipEnd <span class="token operator">=</span> <span class="token number">20</span><span class="token operator">/</span><span class="token number">40</span><span class="token punctuation">;</span>
<span class="token comment">//Whether animation playback loops</span>
state<span class="token punctuation">.</span>clip<span class="token punctuation">.</span>islooping <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token comment">//Animation state machine, directly play the Stand_new animation state</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>animator<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token string">&quot;Stand_new&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Take a look at the running effect, as shown in Figure 6-3:</p>
<p><img src="img/6-3.gif" style="zoom:50%;"></p>
<p>(Animation 6-3)</p>
<h5 id="612-crossfade"><a name="612-crossfade" class="anchor-navigation-ex-anchor" href="#612-crossfade"><i class="fa fa-link" aria-hidden="true"></i></a>6.1.2 crossFade()</h5>
<p>Animation over blending is used to smoothly transition from one animation state to another within a given amount of time. If one animation jumps to another completely different animation in a short amount of time, the transition usually behaves satisfactorily.</p>
<p>Let&#x2019;s first take a look at the <code>crossFade()</code> method in the Animator animation component. The specific method parameters are as follows:</p>
<pre class="language-"><code class="lang-typescript">    <span class="token comment">/**
     * Perform fusion transition playback between the current animation state and the target animation state.
     * @param name Target animation state.
     * @param transitionDuration transition time, this value is the normalized time of the current animation state, the value is between 0.0~1.0.
     * @param layerIndex layer index.
     * @param normalizedTime Normalized playback start time.
     */</span>
    <span class="token function">crossFade</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> transitionDuration<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> layerIndex<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> normalizedTime<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> Number<span class="token punctuation">.</span><span class="token constant">NEGATIVE_INFINITY</span><span class="token punctuation">)</span>
</code></pre>
<p>Called through code as follows:</p>
<pre class="language-"><code class="lang-typescript"><span class="token comment">//Animation state machine, transition and merge into Run animation state</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>animator<span class="token punctuation">.</span><span class="token function">crossFade</span><span class="token punctuation">(</span><span class="token string">&quot;Run&quot;</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Take a look at the running effect, as shown in Figure 6-4, mixing the standby animation and running animation.</p>
<p><img src="img/6-4.gif" style="zoom:50%;"></p>
<p>(Animation 6-4)</p>
<h5 id="613-pause-animation"><a name="613-pause-animation" class="anchor-navigation-ex-anchor" href="#613-pause-animation"><i class="fa fa-link" aria-hidden="true"></i></a>6.1.3 Pause animation</h5>
<p>Now that we&#x2019;ve talked about playing the animation, let&#x2019;s talk about the pause animation. You can directly use the playback speed of the animation to control the pause and playback of the animation. You can directly set the playback speed of the animation to be paused to 0. To continue playing, you only need to reset the speed to 1.</p>
<pre class="language-"><code class="lang-typescript"><span class="token comment">//pause animation</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>animator<span class="token punctuation">.</span>speed <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
<span class="token comment">//Play animation</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>animator<span class="token punctuation">.</span>speed <span class="token operator">=</span> <span class="token number">1.0</span><span class="token punctuation">;</span>
<span class="token comment">//Play animation at half speed</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>animator<span class="token punctuation">.</span>speed <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">;</span>
</code></pre>
<p>Take a look at the running effect, as shown in the animation 6-5:</p>
<p> <img src="img/6-5.gif" style="zoom:50%;"></p>
<p>(Animation 6-5)</p>
<h4 id="62-get-playback-status"><a name="62-get-playback-status" class="anchor-navigation-ex-anchor" href="#62-get-playback-status"><i class="fa fa-link" aria-hidden="true"></i></a>6.2 Get playback status</h4>
<p>To obtain animation playback status, you need to first use Animator&apos;s <code>animator.getControllerLayer(layerIndex)</code> method:</p>
<pre class="language-"><code class="lang-typescript">    <span class="token comment">/**
     * Get the controller layer.
     */</span>
    <span class="token function">getControllerLayer</span><span class="token punctuation">(</span>layerInex<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">:</span> AnimatorControllerLayer <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_controllerLayers<span class="token punctuation">[</span>layerInex<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
<p>After obtaining <code>AnimatorControllerLayer</code>, use the <code>getCurrentPlayState()</code> method:</p>
<pre class="language-"><code class="lang-typescript">    <span class="token comment">/**
     * Get the current playback status.
     * @return animation playback status.
     */</span>
    <span class="token function">getCurrentPlayState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> AnimatorPlayState <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_playStateInfo<span class="token operator">!</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
<p>After obtaining <code>AnimatorPlayState</code>, there are three commonly used methods to obtain the playback state as follows:</p>
<pre class="language-"><code class="lang-typescript">    <span class="token comment">/**
    * The normalized time of the playback state, the integer is the number of loops, and the decimal is the single playback time.
    */</span>
    <span class="token keyword">get</span> <span class="token function">normalizedTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_normalizedTime<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
    * The duration of the current animation, in seconds.
    */</span>
    <span class="token keyword">get</span> <span class="token function">duration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_duration<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
    * Animation state machine.
    */</span>
    <span class="token keyword">get</span> <span class="token function">animatorState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> AnimatorState <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_currentState<span class="token operator">!</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
<p>Usually we can use <code>normalizedTime</code> to determine whether an animation state has finished playing, such as the following code:</p>
<pre class="language-"><code class="lang-typescript"><span class="token keyword">const</span> <span class="token punctuation">{</span> regClass<span class="token punctuation">,</span> property <span class="token punctuation">}</span> <span class="token operator">=</span> Laya<span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">regClass</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token keyword">extends</span> <span class="token class-name">Laya</span><span class="token punctuation">.</span>Script <span class="token punctuation">{</span>
    <span class="token decorator"><span class="token at operator">@</span><span class="token function">property</span></span><span class="token punctuation">(</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> Laya<span class="token punctuation">.</span>Label <span class="token punctuation">}</span> <span class="token punctuation">)</span>
    <span class="token keyword">private</span> label<span class="token operator">:</span> Laya<span class="token punctuation">.</span>Label<span class="token punctuation">;</span>  
    <span class="token decorator"><span class="token at operator">@</span><span class="token function">property</span></span><span class="token punctuation">(</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> Laya<span class="token punctuation">.</span>Sprite3D <span class="token punctuation">}</span> <span class="token punctuation">)</span>
    <span class="token keyword">private</span> target<span class="token operator">:</span> Laya<span class="token punctuation">.</span>Sprite3D<span class="token punctuation">;</span>

    <span class="token keyword">private</span> animator <span class="token operator">:</span> Laya<span class="token punctuation">.</span>Animator<span class="token punctuation">;</span>

    <span class="token function">onStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>label<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span> Laya<span class="token punctuation">.</span>Event<span class="token punctuation">.</span><span class="token constant">CLICK</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>test <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//Get state machine</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>animator <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">getComponent</span><span class="token generic class-name"><span class="token operator">&lt;</span>Laya<span class="token punctuation">.</span>Animator<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>Laya<span class="token punctuation">.</span>Animator<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//To run the running animation of the state machine, you can use the action fusion method</span>
    <span class="token function">test</span><span class="token punctuation">(</span>e<span class="token operator">:</span> Laya<span class="token punctuation">.</span>Event<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//Animation state machine, transition and merge into Run animation state</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>animator<span class="token punctuation">.</span><span class="token function">crossFade</span><span class="token punctuation">(</span><span class="token string">&quot;Run&quot;</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//Wait for the animation to complete</span>
        Laya<span class="token punctuation">.</span>timer<span class="token punctuation">.</span><span class="token function">frameLoop</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            <span class="token comment">//If the current playback state has been played once</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>animator<span class="token punctuation">.</span><span class="token function">getControllerLayer</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCurrentPlayState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>normalizedTime <span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token comment">//Return to standing state</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>animator<span class="token punctuation">.</span><span class="token function">crossFade</span><span class="token punctuation">(</span><span class="token string">&quot;Stand&quot;</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                Laya<span class="token punctuation">.</span>timer<span class="token punctuation">.</span><span class="token function">clearAll</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Take a look at the running effect, as shown in the animation 6-6:</p>
<p> <img src="img/6-6.gif" style="zoom:50%;"></p>
<p>(Animation 6-6)</p>
<h4 id="63-using-status-scripts"><a name="63-using-status-scripts" class="anchor-navigation-ex-anchor" href="#63-using-status-scripts"><i class="fa fa-link" aria-hidden="true"></i></a>6.3 Using status scripts</h4>
<p>For our development needs, being able to play and switch animation states is not enough. We may also need to implement more requirements in each state. For example, when entering or leaving the next state, playing different sound effects, then by adding animation State scripts can be easily implemented, as shown in Figure 6-7. One or more state scripts can be added to each state.</p>
<p><img src="img/6-7.png" alt="6-7"></p>
<p>(Figure 6-7)</p>
<h5 id="631-create-script"><a name="631-create-script" class="anchor-navigation-ex-anchor" href="#631-create-script"><i class="fa fa-link" aria-hidden="true"></i></a>6.3.1 Create script</h5>
<p>Let&apos;s look at animation 6-8 to see how to create an animation script for a standing state. First, create an animation script in the <code>Project Resources-&gt;src</code> directory, then select the Stand state, and click the <code>+</code> button under <code>Scripts</code> to hang the animation script you just created.</p>
<p><img src="img/6-8.gif" alt="6-8"></p>
<p>(Animation 6-8)</p>
<h5 id="632-script-usage"><a name="632-script-usage" class="anchor-navigation-ex-anchor" href="#632-script-usage"><i class="fa fa-link" aria-hidden="true"></i></a>6.3.2 Script usage</h5>
<p>Let&apos;s take a look at the animation script we just created. The initial code is as follows:</p>
<pre class="language-"><code class="lang-typescript"><span class="token keyword">const</span> <span class="token punctuation">{</span> regClass <span class="token punctuation">}</span> <span class="token operator">=</span> Laya<span class="token punctuation">;</span>
<span class="token keyword">interface</span> <span class="token class-name">AnimatorPlayScriptInfo</span> <span class="token punctuation">{</span>
    animator<span class="token operator">:</span> Laya<span class="token punctuation">.</span>Animator <span class="token operator">|</span> Laya<span class="token punctuation">.</span>Animator2D<span class="token punctuation">;</span>
    layerindex<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
    playState<span class="token operator">:</span> Laya<span class="token punctuation">.</span>AnimatorState <span class="token operator">|</span> Laya<span class="token punctuation">.</span>AnimatorState2D<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
 * Inherited from AnimatorStateScript (animation state script)
 * @author ...
 */</span>
 <span class="token decorator"><span class="token at operator">@</span><span class="token function">regClass</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AnimationScript</span> <span class="token keyword">extends</span> <span class="token class-name">Laya</span><span class="token punctuation">.</span>AnimatorStateScript <span class="token punctuation">{</span>
    <span class="token comment">/**Animation status information */</span>
    playStateInfo<span class="token operator">:</span> AnimatorPlayScriptInfo <span class="token operator">=</span> <span class="token punctuation">{</span> animator<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span> layerindex<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> playState<span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">/**@internal */</span>
    <span class="token function">setPlayScriptInfo</span><span class="token punctuation">(</span>animator<span class="token operator">:</span> Laya<span class="token punctuation">.</span>Animator <span class="token operator">|</span> Laya<span class="token punctuation">.</span>Animator2D<span class="token punctuation">,</span> layerindex<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> playstate<span class="token operator">:</span> Laya<span class="token punctuation">.</span>AnimatorState <span class="token operator">|</span> Laya<span class="token punctuation">.</span>AnimatorState2D<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>playStateInfo<span class="token punctuation">.</span>animator <span class="token operator">=</span> animator<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>playStateInfo<span class="token punctuation">.</span>layerindex <span class="token operator">=</span> layerindex<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>playStateInfo<span class="token punctuation">.</span>playState <span class="token operator">=</span> playstate<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>


    <span class="token comment">/**
     * Executed when the animation state starts.
     */</span>
    <span class="token function">onStateEnter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Animation started playing&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Animation status is running
     * @param normalizeTime 0-1 animation playback status
     */</span>
    <span class="token function">onStateUpdate</span><span class="token punctuation">(</span>normalizeTime<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Animation status updated&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
    * Executed when the animation state exits.
    */</span>
    <span class="token function">onStateExit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Animation exited&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre>
<p>The AnimationScript script inherits from Laya.AnimatorStateScript. <code>setPlayScriptInfo</code> is a life cycle function through which the animation components, animation state machine hierarchy, and animation state machine of the current script can be obtained.</p>
<pre class="language-"><code class="lang-typescript"> <span class="token comment">/**illustrate
     * setPlayScriptInfo is a life cycle function. If you want to obtain animation state machine information, you must call it.
     * @param animator animation component of the current script
     * @param layerindex The animation state machine level where the current script is located
     * @param playState the animation state machine of the current script
     */</span>
     <span class="token function">setPlayScriptInfo</span><span class="token punctuation">(</span>animator<span class="token operator">:</span> Laya<span class="token punctuation">.</span>Animator <span class="token operator">|</span> Laya<span class="token punctuation">.</span>Animator2D<span class="token punctuation">,</span> layerindex<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> playstate<span class="token operator">:</span> Laya<span class="token punctuation">.</span>AnimatorState <span class="token operator">|</span> Laya<span class="token punctuation">.</span>AnimatorState2D<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">this</span><span class="token punctuation">.</span>playStateInfo<span class="token punctuation">.</span>animator <span class="token operator">=</span> animator<span class="token punctuation">;</span>
         <span class="token keyword">this</span><span class="token punctuation">.</span>playStateInfo<span class="token punctuation">.</span>layerindex <span class="token operator">=</span> layerindex<span class="token punctuation">;</span>
         <span class="token keyword">this</span><span class="token punctuation">.</span>playStateInfo<span class="token punctuation">.</span>playState <span class="token operator">=</span> playstate<span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
</code></pre>
<p>This script also has three methods:</p>
<ul>
<li><p>onStateEnter: executed when the animation state starts;</p>
</li>
<li><p>onStateUpdate: The animation state is running, and the length of time for the current state execution can be obtained in the method normalizeTime;</p>
</li>
<li><p>onStateExit: Executed when the animation state exits;</p>
</li>
</ul>
<p>We can override these methods to execute our own logic when the animation state changes. Simply add some code to see the effect:</p>
<pre class="language-"><code class="lang-typescript"><span class="token keyword">const</span> <span class="token punctuation">{</span> regClass <span class="token punctuation">}</span> <span class="token operator">=</span> Laya<span class="token punctuation">;</span>
<span class="token keyword">interface</span> <span class="token class-name">AnimatorPlayScriptInfo</span> <span class="token punctuation">{</span>
    animator<span class="token operator">:</span> Laya<span class="token punctuation">.</span>Animator <span class="token operator">|</span> Laya<span class="token punctuation">.</span>Animator2D<span class="token punctuation">;</span>
    layerindex<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
    playState<span class="token operator">:</span> Laya<span class="token punctuation">.</span>AnimatorState <span class="token operator">|</span> Laya<span class="token punctuation">.</span>AnimatorState2D<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * Inherited from AnimatorStateScript (animation state script)
 * @author ...
 */</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">regClass</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AnimationScript</span> <span class="token keyword">extends</span> <span class="token class-name">Laya</span><span class="token punctuation">.</span>AnimatorStateScript <span class="token punctuation">{</span>
    <span class="token comment">/**Animation status information */</span>
    playStateInfo<span class="token operator">:</span> AnimatorPlayScriptInfo <span class="token operator">=</span> <span class="token punctuation">{</span> animator<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span> layerindex<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> playState<span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> isShow<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> _label<span class="token operator">:</span> Laya<span class="token punctuation">.</span>Label<span class="token punctuation">;</span>
    <span class="token comment">/**@internal */</span>
    <span class="token function">setPlayScriptInfo</span><span class="token punctuation">(</span>animator<span class="token operator">:</span> Laya<span class="token punctuation">.</span>Animator <span class="token operator">|</span> Laya<span class="token punctuation">.</span>Animator2D<span class="token punctuation">,</span> layerindex<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> playstate<span class="token operator">:</span> Laya<span class="token punctuation">.</span>AnimatorState <span class="token operator">|</span> Laya<span class="token punctuation">.</span>AnimatorState2D<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>playStateInfo<span class="token punctuation">.</span>animator <span class="token operator">=</span> animator<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>playStateInfo<span class="token punctuation">.</span>layerindex <span class="token operator">=</span> layerindex<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>playStateInfo<span class="token punctuation">.</span>playState <span class="token operator">=</span> playstate<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_label <span class="token operator">=</span> animator<span class="token punctuation">.</span>owner<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>scene2D<span class="token punctuation">.</span><span class="token function">getChildByName</span><span class="token punctuation">(</span><span class="token string">&quot;Label&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Executed when the animation state starts.
     */</span>
    <span class="token function">onStateEnter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Animation started playing&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_label<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">&quot;Start animation&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Animation status is running
     * @param normalizeTime 0-1 animation playback status
     */</span>
    <span class="token function">onStateUpdate</span><span class="token punctuation">(</span>normalizeTime<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Animation status updated: &quot;</span> <span class="token operator">+</span> normalizeTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>normalizeTime <span class="token operator">&gt;</span> <span class="token number">0.5</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>isShow<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>isShow <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>_label<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">&quot;Run the animation halfway&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
    * Executed when the animation state exits.
    */</span>
    <span class="token function">onStateExit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Animation exited&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_label<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">&quot;Exit running animation&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre>
<p>The actual operation effect is as shown in the animation 6-9.</p>
<p><img src="img/6-9.gif" style="zoom:40%;"></p>
<p>(Animation 6-9)</p>
<h2 id="7-sub-state-machine"><a name="7-sub-state-machine" class="anchor-navigation-ex-anchor" href="#7-sub-state-machine"><i class="fa fa-link" aria-hidden="true"></i></a>7. Sub-state machine</h2>
<p>A sub-state machine is to create a new state machine inside the state machine. This new state machine is called a sub-state machine.</p>
<p>The function of this state machine is to create another set of states to facilitate the management of complex animation states. For example, the character in the game has standby/run/attack/defense when standing, and another set of standby/run/attack/defense when crouching. Then squatting is a sub-state, because squatting, running, squatting and attacking are all based on the squatting state, so they can independently become a sub-state machine.</p>
<h4 id="71-create-sub-state-machine"><a name="71-create-sub-state-machine" class="anchor-navigation-ex-anchor" href="#71-create-sub-state-machine"><i class="fa fa-link" aria-hidden="true"></i></a>7.1 Create sub-state machine</h4>
<p>As shown in the animation in Figure 7-1, right-click the blank position of the state machine and select Create Node Directory. A node named &quot;New StateMachine&quot; will be generated, which is the sub-state machine. Double-click the sub-state machine to enter the sub-state machine panel. In this panel, you can see three states: enter, any state and exit. These three states belong to the sub-state machine, not the parent state machine. The parent state machine only has entry and any states.</p>
<p><img src="img/7-1.gif" alt="7-1"></p>
<p>(Animation 7-1)</p>
<p>Similarly, we can rename the sub-state machine, as shown in Figure 7-2:</p>
<p><img src="img/7-2.gif" alt="7-2"></p>
<p>(Animation 7-2)</p>
<h4 id="72-edit-sub-state-machine"><a name="72-edit-sub-state-machine" class="anchor-navigation-ex-anchor" href="#72-edit-sub-state-machine"><i class="fa fa-link" aria-hidden="true"></i></a>7.2 Edit sub-state machine</h4>
<p>For example, we want to put all the character&apos;s attack and skill animations into the child state machine and classify them into one category as the character&apos;s attack state, while the parent state machine is only used to handle states such as standby, running, dizziness, death, and victory. Then we enter the child state machine, drag in animations such as attacks and skills and connect them, the same as the previous parent state machine. As shown in animation 7-3:</p>
<p><img src="img/7-3.gif" style="zoom:50%;"></p>
<p>(Animation 7-3)</p>
<h4 id="73-entering-the-sub-state-machine"><a name="73-entering-the-sub-state-machine" class="anchor-navigation-ex-anchor" href="#73-entering-the-sub-state-machine"><i class="fa fa-link" aria-hidden="true"></i></a>7.3 Entering the sub-state machine</h4>
<p>Drag an Attack (Take 001) animation into it. At this time, the <code>Enter</code> state will be connected to this animation, indicating that the default state of the sub-state machine is Attack. As shown in Figure 7-4:</p>
<p><img src="img/7-4.png" alt="image-20221222153958334" style="zoom:45%;"></p>
<p>(Figure 7-4)</p>
<p>Then return to the parent state machine and connect Idle to the child state machine, which is actually equivalent to connecting the <code>enter</code> state in the child state machine. Operate as shown in Figure 7-5:</p>
<p><img src="img/7-5.gif" style="zoom:50%;"></p>
<p>(Animation 7-5)</p>
<h4 id="74-exit-sub-state-machine"><a name="74-exit-sub-state-machine" class="anchor-navigation-ex-anchor" href="#74-exit-sub-state-machine"><i class="fa fa-link" aria-hidden="true"></i></a>7.4 Exit sub-state machine</h4>
<p>If we hope that after the Attack animation ends, the function of the child state machine is completed, and the child state machine exits, returns to the parent state machine, and returns to the Idle state, this process belongs to exiting the child state machine.</p>
<p>In the parent state machine, after returning to the state of the child state machine, you need to continue connecting to other states to make the animation continuous, as shown in animation 7-6:</p>
<p><img src="img/7-6.gif" alt="7-6"></p>
<p>(Animation 7-6)</p>
<footer class="page-footer"><span class="copyright">Copyright &#xA9;Layabox 2022 all right reserved&#xFF0C;powered by <a href="https://layaAir.layabox.com/" target="_blank">LayaAir</a> Engine</span><span class="footer-modification">Update&#xFF1A;
2024-02-22 18:08:33
</span></footer>
<script>console.log("plugin-popup....");document.onclick = function(e){ e.target.tagName === "IMG" && window.open(e.target.src,e.target.src)}</script><style>img{cursor:pointer}</style>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../timelineGUI/readme.html" class="navigation navigation-prev " aria-label="Previous page: timeline GUI">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../aniBake/readme.html" class="navigation navigation-next " aria-label="Next page: Animation Bake">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Animation Controller","level":"1.3.3.2","depth":3,"next":{"title":"Animation Bake","level":"1.3.3.3","depth":3,"path":"IDE/animationEditor/aniBake/readme.md","ref":"IDE/animationEditor/aniBake/readme.md","articles":[]},"previous":{"title":"timeline GUI","level":"1.3.3.1","depth":3,"path":"IDE/animationEditor/timelineGUI/readme.md","ref":"IDE/animationEditor/timelineGUI/readme.md","articles":[]},"dir":"ltr"},"config":{"plugins":["expandable-chapters-small","sidebar-style","anchor-navigation-ex","-lunr","-search","-sharing","search-pro","versions-select","-favicon","favicon-absolute","fontsettings","prism","splitter","code","flexible-alerts","auto-scroll-table","popup","tbfed-pagefooter","-theme-hqbook"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"sidebar-style":{"author":"","title":""},"tbfed-pagefooter":{"copyright":"Copyright ©Layabox 2022","modify_label":"Update：","modify_format":"YYYY-MM-DD HH:mm:ss"},"prism":{"css":["prismjs/themes/prism-solarizedlight.css"],"lang":{"flow":"typescript"},"ignore":["mermaid","eval-js"]},"splitter":{},"search-pro":{},"auto-scroll-table":{},"popup":{},"code":{"copyButtons":true},"versions-select":{"type":"branches"},"favicon-absolute":{"appleTouchIconMore":{},"appleTouchIconPrecomposed152":"./style/layabox-152.png","appleTouchIconPrecomposedMore":{},"favicon":"./style/favicon-32.ico","bookmark":"./style/favicon-32.ico"},"fontsettings":{"family":"sans","size":2,"theme":"white"},"highlight":{},"anchor-navigation-ex":{"associatedWithSummary":true,"float":{"floatIcon":"fa fa-navicon","level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"mode":"float","multipleH1":false,"pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"printLog":false,"showGoTop":true,"showLevel":false},"expandable-chapters-small":{},"flexible-alerts":{"danger":{"className":"danger","icon":"fa fa-ban","label":"Attention"},"note":{"className":"info","icon":"fa fa-info-circle","label":"Note"},"style":"callout","tip":{"className":"tip","icon":"fa fa-lightbulb-o","label":"Tip"},"warning":{"className":"warning","icon":"fa fa-exclamation-triangle","label":"Warning"}},"versions":{"options":[{"value":"https://layaAir.com/3.1/doc/","text":"v3.1"}]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","style":{"website":"style/website.css"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"LayaAir3 Engine Documentation · LAYABOX","gitbook":"*"},"file":{"path":"IDE/animationEditor/aniController/readme.md","mtime":"2024-02-22T10:08:33.201Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2024-03-06T02:40:20.315Z"},"basePath":"../../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../../gitbook/gitbook.js"></script>
    <script src="../../../gitbook/theme.js"></script>
    
        
        <script src="../../../gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-sidebar-style/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search-pro/search.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-versions-select/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-flexible-alerts/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-auto-scroll-table/plugin.js"></script>
        
    

    </body>
</html>

